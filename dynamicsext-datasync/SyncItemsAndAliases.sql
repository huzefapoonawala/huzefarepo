/* Queries to copy new items & aliases from primary db to secondary db */
/* START */

	INSERT INTO [Temp].[dbo].[Item]
		([BinLocation]
		,[BuydownPrice]
		,[BuydownQuantity]
		,[CommissionAmount]
		,[CommissionMaximum]
		,[CommissionMode]
		,[CommissionPercentProfit]
		,[CommissionPercentSale]
		,[Description]
		,[FoodStampable]
		,[HQID]
		,[ItemNotDiscountable]
		,[LastReceived]
		,[LastUpdated]
		,[QuantityCommitted]
		,[SerialNumberCount]
		,[TareWeightPercent]
		,[ItemLookupCode]
		,[DepartmentID]
		,[CategoryID]
		,[MessageID]
		,[Price]
		,[PriceA]
		,[PriceB]
		,[PriceC]
		,[SalePrice]
		,[SaleStartDate]
		,[SaleEndDate]
		,[QuantityDiscountID]
		,[TaxID]
		,[ItemType]
		,[Cost]
		,[Quantity]
		,[ReorderPoint]
		,[RestockLevel]
		,[TareWeight]
		,[SupplierID]
		,[TagAlongItem]
		,[TagAlongQuantity]
		,[ParentItem]
		,[ParentQuantity]
		,[BarcodeFormat]
		,[PriceLowerBound]
		,[PriceUpperBound]
		,[PictureName]
		,[LastSold]
		,[SubDescription1]
		,[SubDescription2]
		,[SubDescription3]
		,[UnitOfMeasure]
		,[SubCategoryID]
		,[QuantityEntryNotAllowed]
		,[PriceMustBeEntered]
		,[BlockSalesReason]
		,[BlockSalesAfterDate]
		,[Weight]
		,[Taxable]
		,[BlockSalesBeforeDate]
		,[LastCost]
		,[ReplacementCost]
		,[WebItem]
		,[BlockSalesType]
		,[BlockSalesScheduleID]
		,[SaleType]
		,[SaleScheduleID]
		,[Consignment]
		,[Inactive]
		,[LastCounted]
		,[DoNotOrder]
		,[MSRP]
		,[DateCreated]
		,[UsuallyShip]
		,[NumberFormat]
		,[ItemCannotBeRet]
		,[ItemCannotBeSold]
		,[IsAutogenerated]
		,[IsGlobalvoucher]
		,[DeleteZeroBalanceEntry]
		,[TenderID]
		,[Notes]
		,[ExtendedDescription]
		,[Content])
	select TOP 10
		[BinLocation]
		,[BuydownPrice]
		,[BuydownQuantity]
		,[CommissionAmount]
		,[CommissionMaximum]
		,[CommissionMode]
		,[CommissionPercentProfit]
		,[CommissionPercentSale]
		,[Description]
		,[FoodStampable]
		,[HQID]
		,[ItemNotDiscountable]
		,[LastReceived]
		,[LastUpdated]
		,[QuantityCommitted]
		,[SerialNumberCount]
		,[TareWeightPercent]
		,[ItemLookupCode]
		,[DepartmentID]
		,[CategoryID]
		,[MessageID]
		,[Price]
		,[PriceA]
		,[PriceB]
		,[PriceC]
		,[SalePrice]
		,[SaleStartDate]
		,[SaleEndDate]
		,[QuantityDiscountID]
		,[TaxID]
		,[ItemType]
		,[Cost]
		,[Quantity]
		,[ReorderPoint]
		,[RestockLevel]
		,[TareWeight]
		,[SupplierID]
		,[TagAlongItem]
		,[TagAlongQuantity]
		,[ParentItem]
		,[ParentQuantity]
		,[BarcodeFormat]
		,[PriceLowerBound]
		,[PriceUpperBound]
		,[PictureName]
		,[LastSold]
		,[SubDescription1]
		,[SubDescription2]
		,[SubDescription3]
		,[UnitOfMeasure]
		,[SubCategoryID]
		,[QuantityEntryNotAllowed]
		,[PriceMustBeEntered]
		,[BlockSalesReason]
		,[BlockSalesAfterDate]
		,[Weight]
		,[Taxable]
		,[BlockSalesBeforeDate]
		,[LastCost]
		,[ReplacementCost]
		,[WebItem]
		,[BlockSalesType]
		,[BlockSalesScheduleID]
		,[SaleType]
		,[SaleScheduleID]
		,[Consignment]
		,[Inactive]
		,[LastCounted]
		,[DoNotOrder]
		,[MSRP]
		,CURRENT_TIMESTAMP as [DateCreated]
		,[UsuallyShip]
		,[NumberFormat]
		,[ItemCannotBeRet]
		,[ItemCannotBeSold]
		,[IsAutogenerated]
		,[IsGlobalvoucher]
		,[DeleteZeroBalanceEntry]
		,[TenderID]
		,[Notes]
		,[ExtendedDescription]
		,[Content]
	from [Beta].[dbo].[Item] i1 
	where ItemLookupCode not in (select ItemLookupCode from Temp.dbo.Item)
	order by ItemLookupCode;

	INSERT INTO [Temp].[dbo].[Alias]
			   ([ItemID]
			   ,[Alias])
	select t2.ID, t1.Alias from(
		select i.ItemLookupCode, a.Alias from [Beta].[dbo].[Alias] a inner join [Beta].[dbo].[Item] i on i.ID = a.ItemID where Alias not in (select Alias from Temp.dbo.Alias)
	) t1 inner join Temp.dbo.Item t2 on t2.ItemLookupCode = t1.ItemLookupCode;

/* END */